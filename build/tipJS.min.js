/*
 tipJS - OpenSource Javascript MVC Framework ver.2.0.0
 Copyright 2013.08 
 Dual licensed under the MIT or GPL Version 2 licenses
 Author: SeungHyun PAEK, Hanghee Yi
 HomePage: http://www.tipjs.com
 Contact: http://www.tipjs.com/contact
 License: MIT, GPL V2
 create date: 2013-09-22 */!function(a){"use strict";var b={};b.ver=b.version=b.VERSION="2.0.0",a.tipJS=b;for(var c=b.util={},d=Object.prototype.toString,e=["Arguments","Function","Number","String","Date","RegExp","Boolean"],f=function(a){c["is"+a]=function(b){return d.call(b)==="[object "+a+"]"}},g=0,h=e.length;h>g;g++)f(e[g]);c.isArray=Array.isArray||function(a){return"[object Array]"===d.call(a)},c.isObject=function(a){return a===Object(a)},c.toArray=function(a){var b=[];if(a.length)for(var c=0,d=a.length;d>c;c++)b[c]=a[c];return b},c.getById=function(a,b){return b?b.getElementById(a):document.getElementById(a)},c.getByName=function(a,b){return b?b.getElementsByName(a):document.getElementsByName(a)},c.getByTag=function(a,b){return b?b.getElementsByTagName(a):document.getElementsByTagName(a)},c.mergeObject=function(a,b){for(var c in b)a[c]||(a[c]=b[c]);return a},c.cloneObject=function(a,b){if(null==a||"object"!=typeof a)return a;if(b)return i(a);var d=a instanceof Array?[]:{};for(var e in a)d[e]="object"==typeof a[e]?c.cloneObject(a[e],!1):a[e];return d},c.hasChild=function(a){for(var b in a)if("object"==typeof a[b])return!0;return!1},c.uniqArray=function(a){for(var b=[],c=a.length,d=0;c>d;d++){for(var e=d+1;c>e;e++)a[d]===a[e]&&(e=++d);b.push(a[d])}return b},c.loadJS=function(a,b){var d=document.createElement("script");d.type="text/javascript",d.src=P.define?P.define.getNoCacheUrl(a):a,d.charset=S.charSet,b&&(d.readyState?d.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&(this.onreadystatechange=null,b(this))}:d.onload=function(){b(this)}),c.getByTag("head")[0].appendChild(d)};var i=function(a){return i=c.isFunction(Object.create)?function(a){return Object.create(a)}:function(a){function b(){}return b.prototype=a,new b},i(a)},j=b.echo=function(a,b,c){if(!c||!("string"!=typeof c||"string"==typeof c&&c.split(".").length+c.split("]").length>3)){if(b||(b=""),null===a||void 0===a)return console.log((c?c+".":"")+a),void 0;if("object"!=typeof a)return(typeof a==b||""===b)&&console.log((c?c+".":"")+a+"["+typeof a+"]"),void 0;a instanceof Array?console.log((c?c+":":"")+"[Array["+a.length+"]]"):console.log((c?c+":":"")+"[Object]");for(var d in a)a instanceof Array?"object"==typeof a[d]?j(a[d],b,(c?c+"[":"[")+d+(c?"]":"]")):(typeof a[d]==b||""===b)&&console.log((c?c+"[":"[")+d+(c?"]":"]")+":"+a[d]+" ("+typeof a[d]+")"):"object"==typeof a[d]?j(a[d],b,(c?c+".":"")+d):(typeof a[d]==b||""===b)&&console.log((c?c+".":"")+d+":"+a[d]+" ("+typeof a[d]+")")}},k=function(a){return"Please define "+a},l=function(a,b){if(c.isArray(a)){for(var d=a.length;d--;)if(a[d]==b)return!0}else if(a==b)return!0;return!1},m=function(a,b){var d=a.__extend;if(!d)return a;if(c.isString(d))a=n(a,d,b);else if(d instanceof Array)for(var e=d.length;e--;)a=n(a,d[e],b);return a},n=function(a,b,d){return"model"==d?c.mergeObject(a,c.cloneObject(s(b))):c.mergeObject(a,c.cloneObject(t(b)))},o=function(){return o=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},o()},p=function(a,b,d){if(!c.isObject(d))throw new Error(k(a));if(!c.isString(b))throw new Error(k(a));if(d.__extend&&"controllers"!=a&&"interceptors"!=a&&l(d.__extend,b))throw new Error("Can't extend itself: "+b);if(!P)throw new Error(k(a));if(P.loadOrder.presentOrder()===a)switch(a){case"interceptors":case"controllers":case"models":case"views":L[a][b]=d}},q=function(a,d){var e=S.path[d],f=a.appPath?a.appPath:".";if("lang"===d&&a.localSet)return a[d]=[f+"/"+e+"/"+b.lang+".js"],a[d];for(var g=c.uniqArray(a[d]),h=[],i=g.length;i--;)h.push(f+"/"+e+"/"+g[i]);return h},r=function(a){K[a]=K[a]||{};var b=K[a].requireList=q(P.define,a);if(b.length>0)for(var d=b.length;d--;)c.loadJS(b[d],function(b){C(a,b.src)&&B()});else B()},s=function(a,b){var d=L.models;if(!d[a]||void 0===d[a])throw new Error("Can't find model: "+a);if(b===!0){var e=L.syncModels;if(e||(e=L.syncModels={}),e[a])return e[a];var f=e[a]=c.cloneObject(d[a],T["models"+a]);return c.isFunction(f.__init)&&f.__init(),f}var g=c.cloneObject(d[a],T["models"+a]);return c.isFunction(g.__init)&&g.__init(),g},t=function(a){var b=L.views;if(!b||!b[a]||void 0===b[a])throw new Error("Can't find view: "+a);var d=c.cloneObject(b[a],T["views"+a]);return c.isFunction(d.__init)&&d.__init(),d},u=function(){var a,d,e,f=L.controllers;for(a in f)d=c.cloneObject(f[a]),e={controllerName:a,getModel:s,getView:t,render:E,getById:c.getById,getByName:c.getByName,getByTag:c.getByTag},b.action[a]=function(a,d){return function(){var e,f,g=arguments;b.isDevelopment===!0&&(e=o()),P.define.beforeController&&P.define.beforeController.apply(a,arguments)===!1||(f=function(){if(d.exceptionInvoke)try{v(d,g)}catch(f){(g=c.toArray(g)).unshift(f),d.exceptionInvoke.apply(d,g)}else v(d,g);P.define.afterController&&P.define.afterController.apply(a,g),b.isDevelopment===!0&&b.debug(a.controllerName+" completed in "+(o()-e)/1e3+" seconds")},d.async===!0?setTimeout(f,d.delay?d.delay:15):f())}}(e,d)},v=function(a,b){a.beforeInvoke&&a.beforeInvoke.apply(a,b)===!1||a.invoke&&a.invoke.apply(a,b)===!1||a.afterInvoke&&a.afterInvoke.apply(a,b)},w=function(){var a,b,d,e,f,g=L.interceptors;for(var h in g)b=d=e=[],a=g[h],f=a.order?a.order:0,a.target&&(b=c.isArray(a.target)?a.target:[a.target]),a.before&&(d=c.isArray(a.before)?a.before:[a.before]),a.after&&(e=c.isArray(a.after)?a.after:[a.after]),M.push({order:f,scope:b,before:d,after:e});M.sort(function(a,b){return a.order-b.order})},x=function(a,b,c){return function(){for(var d,e=c.before,f=0,g=e.length;g>f;f++)if(d=e[f].apply(b,arguments),void 0!==d)return d;return d=a.apply(b,arguments),void 0!==d?d:void 0}},y=function(a,b,c){return function(){var d,e=c.after;if(d=a.apply(b,arguments),void 0!==d)return d;for(var f=0,g=e.length;g>f;f++)if(d=e[f].apply(b,arguments),void 0!==d)return d}},z=function(a,b,d,e){var f=b.split("."),g=L[a];if(1!=f.length||a!=b&&a+"*"!=b){if(2==f.length&&a==f[0]){var h=f[1];for(var i in g)if(i==h||h.indexOf("*")>0&&0==i.indexOf(h.substr(0,h.indexOf("*")))){var j=g[i];for(var k in j)c.isFunction(j[k])&&(j[k]=e(j[k],j,d))}}else if(3==f.length&&a==f[0]){var h=f[1],l=f[2];for(var i in g)if(i==h){var j=g[i];for(var k in j)(k==l||l.indexOf("*")>0&&0==k.indexOf(l.substr(0,l.indexOf("*"))))&&c.isFunction(j[k])&&(j[k]=e(j[k],j,d))}}}else for(var i in g){var j=g[i];for(var k in j)c.isFunction(j[k])&&(j[k]=e(j[k],j,d))}},A=function(a){for(var b=M.length;b--;)for(var c=M[b],d=c.scope,e=0,f=d.length;f>e;e++)z(a,d[e],c,x);for(var b=0,g=M.length;g>b;b++)for(var c=M[b],d=c.scope,e=0,f=d.length;f>e;e++)z(a,d[e],c,y)},B=function(){var a,d;if(P.loadOrder.isLastOrder()===!1)return r(P.loadOrder.nextOrder()),void 0;w();var e=L.controllers;if(e){A("controllers");for(a in e)e[a].getModel=s,e[a].getView=t,e[a].render=E,e[a].getById=c.getById,e[a].getByName=c.getByName,e[a].getByTag=c.getByTag;u()}var f=L.models;if(f){A("models");for(a in f)d=a,m(f[a],"model"),d.lastIndexOf("VO")!=d.length-2&&(f[a].getModel=s,f[a].getById=c.getById,f[a].getByName=c.getByName,f[a].getByTag=c.getByTag),T["models"+d]=!c.hasChild(f[a])}var g=L.views;if(g){A("views");for(a in g)d=a,m(g[a],"view"),g[a].getView=t,g[a].render=E,g[a].getById=c.getById,g[a].getByName=c.getByName,g[a].getByTag=c.getByTag,T["views"+d]=!c.hasChild(g[a])}if(b.debug("tipJS version "+b.version+"["+b.lang+"]"),c.isArray(P.onLoadArgs)||(P.onLoadArgs=[]),P.define.onLoad.apply(P.define,P.onLoadArgs),H){for(var h=0,i=H.length;i>h;h++){var j=H[h],k=b.action[j.name];k.apply(k,j.param)}H=null}},C=function(a,b){var c,d,e=K[a].requireList;for(c=e.length;c--;)if(e[c]!==!0&&(d=e[c].indexOf("./")>-1?e[c].substr(e[c].lastIndexOf("./")+1):e[c],b.indexOf(d)>-1)){e[c]=!0;break}for(c=e.length;c--;)if(e[c]!==!0)return!1;return!0};b.config=function(a){if(S=c.mergeObject(a,N.config),null===b.isDevelopment)for(var d=S.developmentHostList.length;d--;)if(null!==U.hostname.match(S.developmentHostList[d])){b.isDevelopment=!0;break}},b.benchmark={},b.benchmark.mark=function(a){O[a]=o()},b.benchmark.elapsedTime=function(a,c,d){var e=O[a],f=O[c],g=(f-e)/1e3;return d?d(a,c,e,f,g):b.log("elapsed time["+a+" to "+c+"] : "+g+" seconds","[BENCHMARK]"),g};var D=function(){var a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}return D=function(){return a},D()},E=b.render=function(a){var b;if(arguments.length>1)return F(arguments[0],arguments[1],arguments[2]);if(P.define.templateCache&&R[a.url])return b=F(R[a.url],a.data,a.tplId),c.isString(a.renderTo)&&(c.getById(a.renderTo).innerHTML+=b),b;var d=D();d.open("GET",P.define.getNoCacheUrl(a.url),!1);try{d.send(null)}catch(e){return null}if(4==d.readyState&&200==d.status)return b=R[a.url]=d.responseText,b=F(b,a.data,a.tplId),c.isString(a.renderTo)&&(c.getById(a.renderTo).innerHTML+=b),b;throw new Error("Can't find templates file: "+a.url)},F=function(a,b,d){if(a=a.replace(/\r\n/g,"\n"),a=a.replace(/\r/g,"\n"),a=a.replace(/\\/g,"\\\\"),a=a.replace(/\n/g,""),c.isString(d)){for(var e=a.split("[[#"),f=new RegExp("^"+d+"]]"),g=0,h=e.length;h>g;g++)if(e[g].match(f)){a=e[g].replace(f,"");break}}else a=a.replace(/\[\[#[a-zA-Z0-9_-]*\]\]/g,"");var i=a.split("@>"),j=new Function("data",G(i));return j(b)},G=function(a){var b,c,d,e,f=[],g=[],h=[],i="PLN",j="VAL",k="PAS",l="__tempArr__.push(";for(f.push("var __tempArr__ = [];"),b=0,c=a.length;c>b;b++)d=a[b],d.indexOf("<@=")>-1?(e=d.split("<@="),e.length>1?(h.push(e[0].replace(/"/g,'\\"')),h.push(e[1]),g.push(i),g.push(j)):(h.push(e[0]),g.push(j))):d.indexOf("<@")>-1?(e=d.split("<@"),e.length>1?(h.push(e[0].replace(/"/g,'\\"')),h.push(e[1]),g.push(i),g.push(k)):(h.push(e[0]),g.push(k))):(h.push(d.replace(/"/g,'\\"')),g.push(i));for(b=0,c=h.length;c>b;b++)d=h[b],g[b]==j?(d='""+'+d+'+""',f.push(l+d+");")):g[b]==k?f.push(d):(d='"'+d+'"',f.push(l+d+");"));return f.push("return __tempArr__.join('');"),f.join("")};b.log=function(a,b){window.console=window.console||{log:function(){},error:function(){}};var c=new Date,d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate(),g=c.getHours(),h=c.getMinutes(),i=c.getSeconds(),j=c.getMilliseconds();console.log((b?b:"")+d+"/"+e+"/"+f+" "+g+":"+h+":"+i+"."+j+" "+a)},b.debug=function(a){b.isDevelopment&&b.log(a,"[DEBUG]")},b.localSet=function(a){"lang"===P.loadOrder.presentOrder()&&(Q=a)},b.msg=function(a){return Q[a]?Q[a]:a},b.interceptor=function(a,b){p("interceptors",a,b)},b.controller=function(a,b){p("controllers",a,b)},b.model=function(a,b){p("models",a,b)},b.view=function(a,b){p("views",a,b)},b.action=function(a){var d,e;if(!arguments.length)return b.action;var f=arguments[0],g=c.toArray(arguments).slice(1);if(d=f.split("."),0==a.length)throw new Error("tipJS.action : invalid parameter");return P.loadOrder&&P.loadOrder.isLastOrder()?(e=b.action[a],e.apply(e,g),void 0):(H=H||[],H.push({name:f,param:g}),void 0)},b.loadApp=function(){if(I){var a=c.toArray(arguments);a.length&&(P.onLoadArgs=a),J(),delete b.loadApp}},b.app=function(a){I=a};var H,I,J=function(){var a=I;c.mergeObject(a,N.define),void 0===a.templateCache&&(a.templateCache=S.templateCache),void 0===a.noCache?(a.noCache=S.noCache,a.noCacheVersion=S.noCacheVersion,a.noCacheParam=S.noCacheParam,a.noCacheAuto=S.noCacheAuto):a.noCache===!0&&(void 0===a.noCacheVersion&&(a.noCacheVersion=S.noCacheVersion),void 0===a.noCacheParam&&(a.noCacheParam=S.noCacheParam),void 0===a.noCacheAuto&&(a.noCacheAuto=S.noCacheAuto)),a.getNoCacheUrl=function(a){return this.noCache===!1?a:(a+=a.indexOf("?")<0?"?":"&",a+=this.noCacheParam+"="+(this.noCacheAuto===!0?""+Math.random():this.noCacheVersion))},P.define=a,c.mergeObject(P.loadOrder={},N.loadOrder),r(P.loadOrder.presentOrder())},K={},L={interceptors:{},controllers:{},models:{},views:{}},M=[],N={config:{noCache:!1,noCacheVersion:b.ver,noCacheParam:"tipJS",noCacheAuto:!1,templateCache:!0,charSet:"utf-8",path:{lang:"lang",interceptors:"interceptors",controllers:"controllers",models:"models",views:"views"},developmentHostList:[]},define:{lang:[],interceptors:[],controllers:[],models:[],views:[],localSet:!1,onLoad:function(){},beforeController:function(){},afterController:function(){},getModel:s,getView:t},loadOrder:{index:0,presentOrder:function(){return this.order[this.index]},nextOrder:function(){return this.order[++this.index]},isLastOrder:function(){return this.index+1==this.order.length},order:["lang","interceptors","controllers","models","views"]}},O={},P={},Q={},R={},S=c.cloneObject(N.config),T={},U=window.location,V=U.pathname,W=U.search,X=null,Y=(navigator.language||navigator.systemLanguage||navigator.userLanguage).substr(0,2);(null!==W.match("(\\?|&)debug")||null!==V.match("debug"))&&(X=!0),b.lang=Y,b.isDevelopment=X}(this);